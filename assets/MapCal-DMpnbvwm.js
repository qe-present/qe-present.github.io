import{Q as V}from"./QTooltip-DEhSG-AF.js";import{_ as P,L as D,s as g,t as w,u as n,v as s,M as k,Q as _,N as A,F as h,y as p,O as x,P as B,r as M,J as l,R as C,G}from"./index-BeDRb2ke.js";import{M as Q,G as y}from"./GetMap-36Ulmno2.js";import{u as U}from"./setting-store-BOv0A4W_.js";import{c as T}from"./tool-D9ZRlb0_.js";import{Q as $,a as q}from"./QBar-b4gD8Bsy.js";import{C as N}from"./ClosePopup-BNOKCmVu.js";import"./position-engine-DmxJgGpb.js";import"./selection-A2WYGOvv.js";const u=U(),R=async(o,t)=>{let a=new L.supermap.MeasureParameters(o,{unit:t});return(await new L.supermap.MeasureService(Q).measureDistance(a)).result.distance},E=async(o,t)=>{let a=new L.supermap.MeasureParameters(o,{unit:t});return(await new L.supermap.MeasureService(Q).measureArea(a)).result.area},f=async o=>{let t=u.map.unit;if(o._rings[0].length<2)return;let a=await R(o,u.map.unit);o.bindTooltip(a.toFixed(u.map.decimal)+" "+T(t)).openTooltip()},S=async o=>{let t=u.map.unit;console.log(t);let a=t==="METER"?"area-meter":"area-kilometer",e=await E(o,t);o.bindTooltip(e.toFixed(u.map.decimal)+" "+T(a)).openTooltip()},F={__name:"TooltipDialog",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o,{expose:t}){t();const e={bar2:D(o,"modelValue"),ref:M};return Object.defineProperty(e,"__isScriptSetup",{enumerable:!1,value:!0}),e}},H=l("div",null,"CCGIS",-1),I=l("div",{class:"text-h6 content-md-end"},"温馨提示",-1),O=l("div",null,[p("点击地图上的左上角按钮,根据提示进行测量"),l("br"),l("br"),p("从上到下："),l("br"),p("   第三个按钮：测量线段距离。"),l("br"),p("   第四个按钮：测量矩形面积。"),l("br"),p("   第五个按钮：测量多边形面积。"),l("br"),p(" 测量结果在测量完之后会显示在地图上。 ")],-1);function j(o,t,a,e,c,v){return g(),w(B,{modelValue:e.bar2,"onUpdate:modelValue":t[0]||(t[0]=d=>e.bar2=d),persistent:"","transition-show":"flip-down","transition-hide":"flip-up"},{default:n(()=>[s(k,{class:"bg-primary text-white"},{default:n(()=>[s($,null,{default:n(()=>[s(_,{name:"favorite"}),s(_,{name:"favorite"}),H,s(_,{name:"favorite"}),s(_,{name:"favorite"}),s(q),A((g(),w(h,{dense:"",flat:"",icon:"close"},{default:n(()=>[s(V,{class:"bg-white text-primary"},{default:n(()=>[p("关闭")]),_:1})]),_:1})),[[N]])]),_:1}),s(x,{class:"text-center"},{default:n(()=>[I]),_:1}),s(x,{class:"q-pt-none text-left text-h5"},{default:n(()=>[O]),_:1})]),_:1})]),_:1},8,["modelValue"])}const z=P(F,[["render",j],["__file","TooltipDialog.vue"]]),J={__name:"MapCal",setup(o,{expose:t}){t();let a,e=M(!1);const c=(r,i)=>{(r==="Rectangle"||r==="Polygon")&&S(i),r==="Line"&&f(i)};C(()=>{a=y({drawMarker:!1,drawCircle:!1,drawCircleMarker:!1,removeMode:!1,cutPolygon:!1},!0,"zh"),a.on("pm:create",r=>{let i=r.layer,m=r.shape;console.log(i,m),i.on("pm:edit",Y=>{c(m,i)}),c(m,i)}),a.on("pm:drawstart",({workingLayer:r})=>{r.on("pm:vertexadded",i=>{i.shape==="Line"&&f(r)})})});const b={get map(){return a},set map(r){a=r},get tooltip(){return e},set tooltip(r){e=r},calAreaAndLength:c,tooltipHandle:()=>{e.value=!e.value},clearMap:()=>{a.eachLayer(function(r){r._url||a.removeLayer(r)})},onMounted:C,ref:M,get GetMap(){return y},get getDistance(){return f},get getArea(){return S},TooltipDialog:z};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},K={id:"map"},W={class:"q-pa-md q-gutter-sm query"};function X(o,t,a,e,c,v){return g(),G("div",K,[l("div",W,[s(h,{color:"primary",onClick:e.tooltipHandle,icon:"my_location"},{default:n(()=>[s(V,{class:"bg-accent","transition-show":"flip-right","transition-hide":"flip-left"},{default:n(()=>[p(" 使用提示 ")]),_:1})]),_:1}),s(h,{color:"primary",onClick:e.clearMap},{default:n(()=>[p(" 清空 ")]),_:1})]),s(e.TooltipDialog,{modelValue:e.tooltip,"onUpdate:modelValue":t[0]||(t[0]=d=>e.tooltip=d)},null,8,["modelValue"])])}const ie=P(J,[["render",X],["__scopeId","data-v-b64c7e46"],["__file","MapCal.vue"]]);export{ie as default};
